@using NGL.Web.Infrastructure.Security
@model NGL.Web.Models.Student.ProfileModel

@{
    ViewBag.Title = "Profile";
    string downloadFileText = "Download File";
}
<div class="panel panel-gray">
    <h2>Student Profile</h2>
    <div class="row">
        <div class="col-md-3">
            <div class="panel panel-default text-center profile-photo-and-buttons-panel">
                <div class="profile-photo-container">
                    <img class="profile-image" src="@Model.ProfilePhotoUrl"></img>

                    @if ((User as NglPrincipal).HasAccessTo("enrollment", "edit"))
                    {
                        <div class="upload-profile-photo-container">
                            @using (var f = Html.BeginNglForm(method: FormMethod.Post, enctype: EncType.Multipart, action: "uploadPhoto/?usi=" + Model.StudentUsi))
                            {
                                <div class="upload-profile-photo">
                                    <button type="button" class="btn btn-default">
                                        New photo
                                    </button>
                                    <input type="file" class="ghost-btn center-block" name="profilePhoto" accept="image/*" />
                                </div>

                            }
                        </div>
                    }
                    <h3>
                        <strong>
                            @Html.DisplayFor(model => model.FirstName)
                            @Html.DisplayFor(model => model.LastName)
                        </strong>
                    </h3>
                    <p>
                        @Html.DisplayNameFor(model => model.StudentUsi): 
                        @Html.DisplayFor(model => model.StudentUsi)
                    </p>
                    
                </div>

                <div class="btn-group-horizontal">
                    <p>
                        @if ((User as NglPrincipal).HasAccessTo("assessment", "view"))
                        {
                            @Html.ActionLink("Reports", MVC.Assessment.Week(@Model.StudentUsi, null), new { @class = "btn btn-primary" })
                        }
                    </p>
                    <p>
                        @if ((User as NglPrincipal).HasAccessTo("scheduleStudents", "create"))
                        {
                            @Html.ActionLink("Scheduling", MVC.Schedule.Set(Model.StudentUsi), new { @class = "btn btn-default" })
                        }
                    </p>
                </div>
                
            </div>
            <div class="panel panel-default">
                @if ((User as NglPrincipal).HasAccessTo("attendance", "clearAllFlags"))
                {
                    <span id="edit-attendance" class="fa fa-pencil pull-right"></span>
                }

                <h4 class="strong">Attendance</h4>
                <div class="progress profile-progress">
                    <div class="progress-bar" style="width: @Model.AttendancePercentage%;">
                        <span class="sr-only"></span>
                    </div>
                </div>

                <span id="profile-attendance-percentage-value">
                    @Html.DisplayFor(model => model.AttendancePercentage)%
                </span>
                
                <div class="attendance-flags">
                    @for (var i = 0; i < @Model.FlagCount; i++)
                    {
                        if (i == 0) { <span class="fa fa-flag fa-2x great"></span> }
                        else if (i == 1) { <span class="fa fa-flag fa-2x in-danger"></span> }
                        else { <span class="fa fa-flag fa-2x bad"></span> }
                    }
                </div>

                <form hidden="hidden" method="post" id="editFlags" action="@Url.Action(MVC.Attendance.EditFlags(Model.StudentUsi, 0))">
                    <input id="flag-count" class="hidden" type="text" name="newFlagCount" value="@Model.FlagCount" />
                    
                    <div class="text-right top-buffer">
                        @Html.ActionLink("Cancel", MVC.Student.Index(Model.StudentUsi), new { @class = "btn btn-default" })
                        <button class="btn btn-primary" type="submit">Save</button>
                    </div>
                </form>

            </div>
        </div>

        <div class="col-md-7">
            <h4 class="panel panel-default strong">Biographical Information</h4>
            <dl class="dl-horizontal panel panel-default">
                <dt>
                    Sex
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Sex)
                </dd>

                <dt>
                    @Html.DisplayNameFor(model => model.BirthDate)
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.BirthDate)
                </dd>
                <dt>
                    @Html.DisplayNameFor(model => model.HispanicLatinoEthnicity)
                </dt>

                <dd>
                    @Html.DisplayTextFor(model => model.HispanicLatinoEthnicity)
                </dd>

                <dt>
                    Race
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Race)
                </dd>

                <dt>
                    @Html.DisplayNameFor(model => model.HomeLanguage)
                </dt>
                <dd>
                    @Html.DisplayFor(model => model.HomeLanguage)
                </dd>
            </dl>
            <h4 class="panel panel-default strong" data-toggle="collapse" data-parent="#accordion" href="#collapseAcademicDetails">
                @if (Model.AcademicDetail != null && Model.AcademicDetail.PerformanceHistoryFileUrl != null)
                {
                    <span class="fa fa-file-text-o fa-1x"></span>
                }
                @Html.DisplayFor(model => model.AcademicDetail.SchoolYear) Academic Details <i class="fa fa-caret-down arrow"></i>
            </h4>
            <div id="collapseAcademicDetails" class="panel-collapse collapse">
                <dl class="dl-horizontal panel panel-default">
                    
                    @if (Model.AcademicDetail == null)
                    {
                        @Html.Raw("No Information Entered")
                        @Html.ActionLink("Enter Academic Details", MVC.Enrollment.EnterAcademicDetails(@Model.StudentUsi), new {@class="btn pull-right"})
                    }
                    else
                    {
                        <dt>
                            @Html.DisplayNameFor(model => model.AcademicDetail.WritingScore)
                        </dt>
                        <dd>
                            @Html.DisplayFor(model => model.AcademicDetail.WritingScore)<br />
                        </dd>
                        <dt>
                            @Html.DisplayNameFor(model => model.AcademicDetail.ReadingScore)
                        </dt>
                        <dd>
                            @Html.DisplayFor(model => model.AcademicDetail.ReadingScore)<br />
                        </dd>
                        <dt>
                            @Html.DisplayNameFor(model => model.AcademicDetail.MathScore)
                        </dt>
                        <dd>
                            @Html.DisplayFor(model => model.AcademicDetail.MathScore)<br />
                        </dd>
                        <dt>
                            @Html.DisplayNameFor(model => model.AcademicDetail.PerformanceHistory)
                        </dt>
                        <dd>
                            @Html.DisplayFor(model => model.AcademicDetail.PerformanceHistory)<br />
                        </dd>

                        if (Model.AcademicDetail != null && Model.AcademicDetail.PerformanceHistoryFileUrl != null)
                         {
                             <dt>
                                 @Html.DisplayNameFor(model => model.AcademicDetail.PerformanceHistoryFileUrl)
                             </dt>
                             <dd>
                                 <a href="@Model.AcademicDetail.PerformanceHistoryFileUrl">@downloadFileText</a><br />
                             </dd>
                         }
                    }
               
                </dl>
            </div>
            <h4 class="panel panel-default strong" data-toggle="collapse" data-parent="#accordion" href="#collapseProgramStatus">
                @if (Model.ProgramStatus != null && (Model.ProgramStatus.McKinneyVentoFile != null 
                                                  || Model.ProgramStatus.SpecialEducationFile != null
                                                  || Model.ProgramStatus.TestingAccommodationFile != null
                                                  || Model.ProgramStatus.TitleParticipationFile != null))
                {
                    <span class="fa fa-file-text-o fa-1x"></span>
                }
                Program Status <i class="fa fa-caret-down arrow"></i>
            </h4>
            <div id="collapseProgramStatus" class="panel-collapse collapse">
            <dl class="dl-horizontal panel panel-default">
                @if (Model.ProgramStatus == null)
                {
                    @Html.Raw("No Information Entered")
                    @Html.ActionLink("Enter Program Status", MVC.Enrollment.EnterProgramStatus(@Model.StudentUsi), new {@class="btn pull-right"})
                }
                else
                {
                    <dt>
                        @Html.DisplayNameFor(model => model.ProgramStatus.TestingAccommodation)
                    </dt>
                    <dd>
                        @Html.DisplayTextFor(model => model.ProgramStatus.TestingAccommodation)
                        @if (Model.ProgramStatus.TestingAccommodationFile != null)
                            {
                            <a href="@Model.ProgramStatus.TestingAccommodationFile">@downloadFileText</a>
                            }
                        <br />
                    </dd>
                    <dd>
                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.ProgramStatus.BilingualProgram)
                    </dt>
                    <dd>
                        @Html.DisplayTextFor(model => model.ProgramStatus.BilingualProgram)<br />
                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.ProgramStatus.EnglishAsSecondLanguage)
                    </dt>
                    <dd>
                        @Html.DisplayTextFor(model => model.ProgramStatus.EnglishAsSecondLanguage)<br />
                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.ProgramStatus.Gifted)
                    </dt>
                    <dd>
                        @Html.DisplayTextFor(model => model.ProgramStatus.Gifted)<br />
                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.ProgramStatus.SpecialEducation)
                    </dt>
                    <dd>
                        @Html.DisplayTextFor(model => model.ProgramStatus.SpecialEducation)
                        @if (Model.ProgramStatus.SpecialEducationFile != null)
                            {
                            <a href="@Model.ProgramStatus.SpecialEducationFile">@downloadFileText</a>
                            }
                        <br />
                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.ProgramStatus.TitleParticipation)
                    </dt>
                    <dd>
                        @Html.DisplayTextFor(model => model.ProgramStatus.TitleParticipation)
                        @if (Model.ProgramStatus.TitleParticipationFile != null)
                            {
                            <a href="@Model.ProgramStatus.TitleParticipationFile">@downloadFileText</a>
                            }
                        <br />
                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.ProgramStatus.McKinneyVento)
                    </dt>
                    <dd>
                        @Html.DisplayTextFor(model => model.ProgramStatus.McKinneyVento)
                        @if (Model.ProgramStatus.McKinneyVentoFile != null)
                            {
                            <a href="@Model.ProgramStatus.McKinneyVentoFile">@downloadFileText</a>
                            }
                        <br />
                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.ProgramStatus.FoodServiceEligibilityStatus)
                    </dt>
                    <dd>
                        @Html.DisplayTextFor(model => model.ProgramStatus.FoodServiceEligibilityStatus)<br />
                    </dd>
                }
                </dl>
            </div>
            <h4 class="panel panel-default strong" data-toggle="collapse" data-parent="#accordion" href="#collapseHomeAddress">Home Address <i class="fa fa-caret-down arrow"></i></h4>
            <div id="collapseHomeAddress" class="panel-collapse collapse">
                <dl class="dl-horizontal panel panel-default">
                    <dt>
                        @Html.DisplayNameFor(model => model.Address)
                    </dt>

                    <dd>
                        @Html.DisplayTextFor(model => model.Address)
                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.Address2)
                    </dt>
                    <dd>
                        @Html.DisplayTextFor(model => model.Address2)<br />
                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.City)
                    </dt>

                    <dd>
                        @Html.DisplayTextFor(model => model.City)
                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.State)
                    </dt>
                    <dd>
                        @Html.DisplayTextFor(model => model.State)
                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.PostalCode)
                    </dt>

                    <dd>
                        @Html.DisplayTextFor(model => model.PostalCode)
                    </dd>
                </dl>
              </div>
            <h4 class="panel panel-default strong" data-toggle="collapse" data-parent="#accordion" href="#collapseParentInfo">   Parent Info <i class="fa fa-caret-down arrow"></i></h4>
            <div id="collapseParentInfo" class="panel-collapse collapse">
                <div class="panel panel-default">
                    <h4>
                        <strong>
                            @Html.DisplayTextFor(model => model.ProfileParentModel.FirstName)
                            @Html.DisplayTextFor(model => model.ProfileParentModel.LastName)
                        </strong>
                    </h4>
                    <dl class="dl-horizontal">
                        <dt>
                            @Html.DisplayNameFor(model => model.ProfileParentModel.Sex)
                        </dt>

                        <dd>
                            @Html.DisplayTextFor(model => model.ProfileParentModel.Sex)
                        </dd>
                        <dt>
                            @Html.DisplayNameFor(model => model.ProfileParentModel.Relationship)
                        </dt>
                        <dd>
                            @Html.DisplayTextFor(model => model.ProfileParentModel.Relationship)
                        </dd>
                        <dt>
                            @Html.DisplayNameFor(model => model.ProfileParentModel.TelephoneNumber)
                        </dt>

                        <dd>
                            @Html.DisplayTextFor(model => model.ProfileParentModel.TelephoneNumber)
                        </dd>
                        <dt>
                            @Html.DisplayNameFor(model => model.ProfileParentModel.EmailAddress)
                        </dt>

                        <dd>
                            @Html.DisplayTextFor(model => model.ProfileParentModel.EmailAddress)<br />
                        </dd>
                    </dl>
                </div>
                </div>
            <h4 class="panel panel-default strong" data-toggle="collapse" data-parent="#accordion" href="#collapseParentAddress">   Parent Address <i class="fa fa-caret-down arrow"></i></h4>
            <div id="collapseParentAddress" class="panel-collapse collapse">
                <div class="panel panel-default">
                    @if (Model.ProfileParentModel.SameAddressAsStudent == false)
                    {
                        <dl class="dl-horizontal">
                            <dt>
                                @Html.DisplayNameFor(model => model.ProfileParentModel.ProfileParentAddressModel.Address)
                            </dt>
                            <dd>
                                @Html.DisplayTextFor(model => model.ProfileParentModel.ProfileParentAddressModel.Address)
                            </dd>
                            <dt>
                                @Html.DisplayNameFor(model => model.ProfileParentModel.ProfileParentAddressModel.Address2)
                            </dt>
                            <dd>
                                @Html.DisplayTextFor(model => model.ProfileParentModel.ProfileParentAddressModel.Address2)
                            </dd>
                            <dt>
                                @Html.DisplayNameFor(model => model.ProfileParentModel.ProfileParentAddressModel.City)
                            </dt>
                            <dd>
                                @Html.DisplayTextFor(model => model.ProfileParentModel.ProfileParentAddressModel.City)
                            </dd>
                            <dt>
                                @Html.DisplayNameFor(model => model.ProfileParentModel.ProfileParentAddressModel.State)
                            </dt>
                            <dd>
                                @Html.DisplayTextFor(model => model.ProfileParentModel.ProfileParentAddressModel.State)
                            </dd>
                            <dt>
                                @Html.DisplayNameFor(model => model.ProfileParentModel.ProfileParentAddressModel.PostalCode)
                            </dt>
                            <dd>
                                @Html.DisplayTextFor(model => model.ProfileParentModel.ProfileParentAddressModel.PostalCode)
                            </dd>
                        </dl>
                    }
                    else
                    {
                        <p>Same as student</p><br />
                    }
                </div>
                </div>
                @if (Model.SecondProfileParentModel != null)
                {

                    <h4 class="panel panel-default strong" data-toggle="collapse" data-parent="#accordion" href="#collapseSecondParent">   Second Parent <i class="fa fa-caret-down arrow"></i></h4>
                    <div id="collapseSecondParent" class="panel-collapse collapse">
                        <div class="panel panel-default">
                            <h4>
                                <strong>
                                    @Html.DisplayTextFor(model => model.SecondProfileParentModel.FirstName) @Html.DisplayTextFor(model => model.SecondProfileParentModel.LastName)
                                </strong>
                            </h4>
                            <dl class="dl-horizontal">
                                <dt>
                                    @Html.DisplayNameFor(model => model.SecondProfileParentModel.Sex)
                                </dt>

                                <dd>
                                    @Html.DisplayTextFor(model => model.SecondProfileParentModel.Sex)
                                </dd>
                                <dt>
                                    @Html.DisplayNameFor(model => model.SecondProfileParentModel.Relationship)
                                </dt>
                                <dd>
                                    @Html.DisplayTextFor(model => model.SecondProfileParentModel.Relationship)
                                </dd>
                                <dt>
                                    @Html.DisplayNameFor(model => model.SecondProfileParentModel.TelephoneNumber)
                                </dt>

                                <dd>
                                    @Html.DisplayTextFor(model => model.SecondProfileParentModel.TelephoneNumber)
                                </dd>
                                <dt>
                                    @Html.DisplayNameFor(model => model.SecondProfileParentModel.EmailAddress)
                                </dt>

                                <dd>
                                    @Html.DisplayTextFor(model => model.SecondProfileParentModel.EmailAddress)<br />
                                </dd>
                            </dl>
                        </div>
                    </div>
                    
                    <h4 class="panel panel-default strong" data-toggle="collapse" data-parent="#accordion" href="#collapseSecondParentAddress">   Second Parent Address <i class="fa fa-caret-down arrow"></i></h4>
                    <div id="collapseSecondParentAddress" class="panel-collapse collapse">
                        <div class="panel panel-default">
                            @if (Model.SecondProfileParentModel.SameAddressAsStudent == false)
                            {
                                <dl class="dl-horizontal">
                                    <dt>
                                        @Html.DisplayNameFor(model => model.SecondProfileParentModel.ProfileParentAddressModel.Address)
                                    </dt>
                                    <dd>
                                        @Html.DisplayTextFor(model => model.SecondProfileParentModel.ProfileParentAddressModel.Address)
                                    </dd>
                                    <dt>
                                        @Html.DisplayNameFor(model => model.SecondProfileParentModel.ProfileParentAddressModel.Address2)
                                    </dt>
                                    <dd>
                                        @Html.DisplayTextFor(model => model.SecondProfileParentModel.ProfileParentAddressModel.Address2)
                                    </dd>
                                    <dt>
                                        @Html.DisplayNameFor(model => model.SecondProfileParentModel.ProfileParentAddressModel.City)
                                    </dt>
                                    <dd>
                                        @Html.DisplayTextFor(model => model.SecondProfileParentModel.ProfileParentAddressModel.City)
                                    </dd>
                                    <dt>
                                        @Html.DisplayNameFor(model => model.SecondProfileParentModel.ProfileParentAddressModel.State)
                                    </dt>
                                    <dd>
                                        @Html.DisplayTextFor(model => model.SecondProfileParentModel.ProfileParentAddressModel.State)
                                    </dd>
                                    <dt>
                                        @Html.DisplayNameFor(model => model.SecondProfileParentModel.ProfileParentAddressModel.PostalCode)
                                    </dt>
                                    <dd>
                                        @Html.DisplayTextFor(model => model.SecondProfileParentModel.ProfileParentAddressModel.PostalCode)
                                    </dd>
                                </dl>
                            }
                            else
                            {
                                <p>Same as student</p><br />
                            }
                        </div>
                    </div>
                }
            </div>
    </div>
</div>

@section Scripts {
    Ngl.student.index.init();
    Ngl.shared.accordianArrows.init();
}
